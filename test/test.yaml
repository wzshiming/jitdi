apiVersion: jitdi.zsm.io/v1alpha1
kind: Image
metadata:
  name: file-test
spec:
  match: "k8s/{base}/{file}:{tag}"
  baseImage: "m.daocloud.io/docker.io/library/{base}:latest"
  mutates:
  - file:
      source: "https://files.m.daocloud.io/dl.k8s.io/{tag}/bin/{GOOS}/{GOARCH}/{file}"
      destination: "/usr/local/bin/{file}"
      mode: '0755'
---
apiVersion: jitdi.zsm.io/v1alpha1
kind: Image
metadata:
  name: file-amd64-test
spec:
  match: "k8s-amd64/{base}/{file}:{tag}"
  baseImage: "m.daocloud.io/docker.io/amd64/{base}:latest"
  mutates:
  - file:
      source: "https://files.m.daocloud.io/dl.k8s.io/{tag}/bin/{GOOS}/{GOARCH}/{file}"
      destination: "/usr/local/bin/{file}"
      mode: '0755'
---
apiVersion: jitdi.zsm.io/v1alpha1
kind: Image
metadata:
  name: ollama-test
spec:
  match: "ollama/{model}:{tag}"
  baseImage: "docker.io/ollama/ollama:latest"
  mutates:
  - ollama:
      model: "registry.ollama.ai/library/{model}:{tag}"
      workDir: "/root/.ollama/models"
---
apiVersion: jitdi.zsm.io/v1alpha1
kind: Image
metadata:
  name: mirror-test
spec:
  match: "library/{image}:{tag}"
  baseImage: "m.daocloud.io/docker.io/library/{image}:{tag}"
---
apiVersion: jitdi.zsm.io/v1alpha1
kind: Image
metadata:
  name: amd64-test
spec:
  match: "amd64/{image}:{tag}"
  baseImage: "m.daocloud.io/docker.io/amd64/{image}:{tag}"
